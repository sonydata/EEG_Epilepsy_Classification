Preprocessing pipeline

ğŸ“„ eeg_metadata.xlsx
â”‚
â”œâ”€â”€ Each row: one EEG session (.edf file)
â”‚
â–¼
ğŸ“‹ Sample metadata (100 per class)
â”‚
â”œâ”€â”€ epilepsy (1)     â”€â”€â”€â”€â”€â”
â””â”€â”€ no_epilepsy (0)  â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
ğŸ“‚ Load .edf file using MNE
     â”‚
     â”œâ”€â”€ Resample to 250 Hz
     â”œâ”€â”€ Bandpass filter (1â€“45 Hz)
     â”œâ”€â”€ Select EEG-only channels
     â”œâ”€â”€ Select subset of relevant channels (F7, T3, T4, T6, CZ)
     â”œâ”€â”€ Skip if:
     â”‚   â”œâ”€â”€ Duration < 5 sec
     â”‚   â””â”€â”€ Missing channels
     â”‚
     â–¼
ğŸ§  Segment into overlapping 5-second epochs
     â”‚
     â”œâ”€â”€ Drop if no valid epochs
     â–¼
ğŸ“Š Convert to long-format DataFrame
     â”‚
     â”œâ”€â”€ Z-score normalize each channel
     â–¼
ğŸ“¦ Collapse into one row per 5-sec epoch
     (arrays per channel)
     â–¼
ğŸ“„ Add to 'eeg_segments' column
     â–¼
ğŸ“‹ Merge with metadata (age, gender, label...)
     â–¼
ğŸ§¾ Flatten: each row = one 5-second segment
     â–¼
ğŸ’¾ Save as Pickle â†’ `preprocessed_data_updated.pkl`
